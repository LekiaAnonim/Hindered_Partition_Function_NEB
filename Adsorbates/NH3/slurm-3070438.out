
CondaError: Run 'conda init' before 'conda deactivate'


CondaError: Run 'conda init' before 'conda activate'

/projects/westgroup/lekia.p/miniforge3/envs/pynta_fairchem/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.7.3' currently installed).
/projects/westgroup/lekia.p/miniforge3/envs/pynta_fairchem/lib/python3.9/site-packages/torchtnt/utils/version.py:12: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
/projects/westgroup/lekia.p/fairchem/src/fairchem/core/models/uma/escn_md.py:130: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
/projects/westgroup/lekia.p/fairchem/src/fairchem/core/models/uma/escn_md.py:130: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
/projects/westgroup/lekia.p/miniforge3/envs/pynta_fairchem/lib/python3.9/site-packages/torch/utils/checkpoint.py:1399: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.
/projects/westgroup/lekia.p/miniforge3/envs/pynta_fairchem/lib/python3.9/site-packages/torch/utils/checkpoint.py:1399: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.

======================================================================
Validating Screening Files in: /projects/westgroup/lekia.p/NEB/Adsorbates/NH3/Screening_Data
======================================================================

✓ VALID PICKLE: screening_results.pkl
  Size: 0.42 MB, Results: 2592
 CORRUPT JSON: screening_metadata.json
  Error: JSON decode failed - file may be truncated
  File size: 74 bytes
  Last 100 chars: ...[
  {
    "site_index": 0,
    "site_type": "ontop",
    "site_position": 

======================================================================
Timestamp Analysis:
======================================================================

⚠ Incomplete sets (missing files): 1
  -  [P--]  (P=pickle, J=json, S=summary)

======================================================================
Summary:
  Total pickle files: 1
  Total JSON files: 0
  Total summary files: 0
  Corrupt files: 1
  Complete sets: 0
======================================================================


======================================================================
Validating Screening Files in: /projects/westgroup/lekia.p/NEB/Adsorbates/NH3/Screening_Data
======================================================================

✓ VALID PICKLE: screening_results.pkl
  Size: 0.42 MB, Results: 2592
 CORRUPT JSON: screening_metadata.json
  Error: JSON decode failed - file may be truncated
  File size: 74 bytes
  Last 100 chars: ...[
  {
    "site_index": 0,
    "site_type": "ontop",
    "site_position": 

======================================================================
Timestamp Analysis:
======================================================================

⚠ Incomplete sets (missing files): 1
  -  [P--]  (P=pickle, J=json, S=summary)

======================================================================
Summary:
  Total pickle files: 1
  Total JSON files: 0
  Total summary files: 0
  Corrupt files: 1
  Complete sets: 0
======================================================================


======================================================================
DRY RUN - Files that WOULD be deleted (3):
======================================================================

  - screening_metadata.json (0.1 KB)
  - screening_metadata.json (0.1 KB)
  - screening_results.pkl (432.1 KB)

⚠ This was a DRY RUN - no files were deleted
To actually delete files, run:
  clean_incomplete_files('/projects/westgroup/lekia.p/NEB/Adsorbates/NH3/Screening_Data', dry_run=False)
======================================================================


======================================================================
Recovering Screening Files in: /projects/westgroup/lekia.p/NEB/Adsorbates/NH3/Screening_Data
======================================================================

Processing timestamp: 
   Loaded pickle: 2592 results
   JSON missing - generating...
   Regenerated JSON: /projects/westgroup/lekia.p/NEB/Adsorbates/NH3/Screening_Data/screening_metadata_.json
   Summary missing - generating...
   Generated summary: /projects/westgroup/lekia.p/NEB/Adsorbates/NH3/Screening_Data/screening_summary_.txt
   Recovery complete for 

======================================================================
 Recovery complete!
  Timestamps processed: 1
  Timestamps recovered: 1
======================================================================


======================================================================
 Screening results loaded successfully!
  File: /projects/westgroup/lekia.p/NEB/Adsorbates/NH3/Screening_Data/screening_results.pkl
  Total configurations: 2592
  Converged: 2592/2592
  Site types: bridge, fcc, hcp, ontop
======================================================================

All site results:
      site_index  ... converged
659           13  ...      True
1475          30  ...      True
2113          44  ...      True
35             0  ...      True
2315          48  ...      True
...          ...  ...       ...
1270          26  ...      True
1262          26  ...      True
926           19  ...      True
1506          31  ...      True
1698          35  ...      True

[2592 rows x 9 columns]
Best site results:
     site_index  ... converged
526          10  ...      True
724          15  ...      True
426           8  ...      True
659          13  ...      True

[4 rows x 9 columns]

Searching for bridge → bridge translation path
  Reference site: pos=(3.51, 6.08)
  Height: 3.0, Rotation: 300.0
  Reference energy: -206.425885 eV
  Found 27 matching configurations

  Candidate neighbors (13):
    d=1.40 Å, ΔE=0.010 meV, pos=(4.21, 4.86)
    d=1.40 Å, ΔE=0.006 meV, pos=(4.91, 6.08)
    d=2.43 Å, ΔE=0.004 meV, pos=(3.51, 3.65)
    d=2.81 Å, ΔE=0.008 meV, pos=(6.32, 6.08)
    d=2.81 Å, ΔE=0.008 meV, pos=(4.91, 3.65)

  ⚠️  All neighbors have |ΔE| < 0.1 meV
      Sites may be symmetry-equivalent (expected for periodic surface)

✓ Selected endpoint (nearest (all ΔE similar)):
  Distance: 1.404 Å
  ΔE: 0.010 meV
  Position: (4.21, 4.86)
  File: /projects/westgroup/lekia.p/NEB/Adsorbates/NH3/Screening_Data/structures/site49_bridge_h3.0_r300.xyz

  Path: high E → low E (ΔE = -0.010 meV)
WARNING: No constraints on structures

Setting up calculators for NEB...
Initial structure energy: -206.425875 eV
Final structure energy: -206.425881 eV
Created 12 images (including 2 endpoints)

Starting NEB optimization...
  Trajectory: /projects/westgroup/lekia.p/NEB/Adsorbates/NH3/NEB_Translation/neb_translation.traj
  Log file: /projects/westgroup/lekia.p/NEB/Adsorbates/NH3/NEB_Translation/neb_translation.log

 NEB optimization completed!

Calculating barriers...
  Forward barrier (fitted): 0.000000 eV (0.000 meV)
  Reaction energy (ΔE): -0.000008 eV
  TS absolute energy: -206.425875 eV
Appears to be only one band in the images.
Processing band          0 /          1/projects/westgroup/lekia.p/fairchem/src/fairchem/core/models/uma/escn_md.py:130: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
/projects/westgroup/lekia.p/miniforge3/envs/pynta_fairchem/lib/python3.9/site-packages/torch/utils/checkpoint.py:1399: FutureWarning: `torch.cpu.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cpu', args...)` instead.


Saddle point: image 0/11
Saddle point saved: /projects/westgroup/lekia.p/NEB/Adsorbates/NH3/NEB_Translation/saddle_translation.traj

Trajectory saved: /projects/westgroup/lekia.p/NEB/Adsorbates/NH3/NEB_Translation/neb_translation.traj
Summary saved to /projects/westgroup/lekia.p/NEB/Adsorbates/NH3/NEB_Translation/neb_summary.json
{'barrier_type': 'translation', 'forward_barrier_fit': 0.0, 'delta_E': -7.62939453125e-06, 'transition_state_energy': -206.4258754344857, 'trajectory': '/projects/westgroup/lekia.p/NEB/Adsorbates/NH3/NEB_Translation/neb_translation.traj', 'saddle_file': '/projects/westgroup/lekia.p/NEB/Adsorbates/NH3/NEB_Translation/saddle_translation.traj', 'saddle_index': 0, 'n_images': 12}
Available rotations: [0.0, 30.0, 60.0, 90.0, 120.0, 150.0, 180.0, 210.0, 240.0, 270.0, 300.0, 330.0]

Selected: 0° → 120° (Δ = 120°)
Energy difference: 0.0 meV
WARNING: Very small energy difference — check if molecule has rotational symmetry
WARNING: No constraints on structures

Setting up calculators for NEB...
Initial structure energy: -206.425448 eV
Final structure energy: -206.425448 eV
Created 12 images (including 2 endpoints)

Starting NEB optimization...
  Trajectory: /projects/westgroup/lekia.p/NEB/Adsorbates/NH3/NEB_Rotation/neb_rotation.traj
  Log file: /projects/westgroup/lekia.p/NEB/Adsorbates/NH3/NEB_Rotation/neb_rotation.log

 NEB optimization completed!

Calculating barriers...
  Forward barrier (fitted): 0.000000 eV (0.000 meV)
  Reaction energy (ΔE): 0.000000 eV
  TS absolute energy: -206.425448 eV
Traceback (most recent call last):
  File "/projects/westgroup/lekia.p/NEB/Adsorbates/NH3/script.py", line 43, in <module>
    images_rot, result_rot = prepare_neb_calculation(
  File "/projects/westgroup/lekia.p/NEB/Adsorbates/model/neb.py", line 1856, in prepare_neb_calculation
    nebtools.plot_bands()
  File "/projects/westgroup/lekia.p/miniforge3/envs/pynta_fairchem/lib/python3.9/site-packages/ase/mep/neb.py", line 1171, in plot_bands
    nimages = self._guess_nimages()
  File "/projects/westgroup/lekia.p/miniforge3/envs/pynta_fairchem/lib/python3.9/site-packages/ase/mep/neb.py", line 1226, in _guess_nimages
    e_nextlast = self.images[2 * nimages - 1].get_potential_energy()
IndexError: list index out of range
